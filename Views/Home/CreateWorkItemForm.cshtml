@model WorkItemFields

<link rel="stylesheet" href="~/css/site.css" />

<form asp-action="CreateWorkItem" method="post" class="work-item-form" enctype="multipart/form-data">
    <div class="logo-container">
        <img src="@Environment.GetEnvironmentVariable("COMPANY_LOGO")" alt="Company Logo" />
    </div>

    <h2>@ViewData["FormTitle"]</h2>
    <p>@ViewData["FormDescription"]</p>

    @await Html.PartialAsync("_FormField", Model.FIELD_1)

    @await Html.PartialAsync("_FormField", Model.FIELD_2)

    @await Html.PartialAsync("_FormField", Model.FIELD_3)

    @await Html.PartialAsync("_FormField", Model.FIELD_4)

    @await Html.PartialAsync("_FormField", Model.FIELD_5)

    @await Html.PartialAsync("_FormField", Model.FIELD_6)

    @await Html.PartialAsync("_FormField", Model.FIELD_7)

    @await Html.PartialAsync("_FormField", Model.FIELD_8)

    @await Html.PartialAsync("_FormField", Model.FIELD_9)

    @await Html.PartialAsync("_FormField", Model.FIELD_10)

    @await Html.PartialAsync("_FormField", Model.FIELD_11)

    @await Html.PartialAsync("_FormField", Model.FIELD_12)

    @await Html.PartialAsync("_FormField", Model.FIELD_13)

    @await Html.PartialAsync("_FormField", Model.FIELD_14)

    @await Html.PartialAsync("_FormField", Model.FIELD_15)

    @if (Model.EnableAttachments)
    {
        <!-- Attachment container -->
        <div class="attachment-container">
            <label for="fileInput">Visual Aids:</label>
            <p>Screenshots, video recordings etc</p>
            <div class="attachment-box" onclick="openFileInput()" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                <p>Drag and drop files here or click to select files</p>
                <span id="fileInputLabel">Select Files</span>
            </div>
            <input type="file" id="fileInput" name="attachments[]" multiple onchange="displaySelectedFiles()">
        </div>
    }

    <button type="submit" class="btn btn-primary">Create Work Item</button>
</form>

<script>
    function openFileInput() {
        document.getElementById('fileInput').click();
    }

    function handleDragOver(event) {
        event.preventDefault();
        event.currentTarget.classList.add('drag-over');
    }

    function handleDrop(event) {
        event.preventDefault();
        event.currentTarget.classList.remove('drag-over');

        const files = event.dataTransfer.files;
        handleFiles(files);
    }

    function displaySelectedFiles() {
        const input = document.getElementById('fileInput');
        const files = input.files;
        handleFiles(files);
    }

    function handleFiles(files) {
        const fileInputLabel = document.getElementById('fileInputLabel');
        fileInputLabel.textContent = `${files.length} file(s) selected`;
    }
</script>